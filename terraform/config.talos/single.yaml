cluster:
  network:
    cni:
      name: flannel
  proxy:
    disabled: false
machine:
  network:
    interfaces:
      - interface: eth1
        addresses:
          - 10.0.1.2/24
  kubelet:
    extraMounts:
      - destination: /var/local-path-provisioner
        type: bind
        source: /var/local-path-provisioner
        options:
          - bind
          - rshared
          - rw
    extraArgs:
      node-labels: "node-role.kubernetes.io/control-plane=,node-role.kubernetes.io/worker="
    nodeIP:
      validSubnets:
        - "10.0.1.0/24"
  firewall:
    # Default to blocking all ingress
    defaultAction: block
    rules:
      # Allow kubelet access within cluster
      - name: kubelet-ingress
        portSelector:
          ports:
            - 10250
          protocol: tcp
        ingress:
          - subnet: 10.0.0.0/16
      # Allow API server access
      - name: kubernetes-api-ingress
        portSelector:
          ports:
            - 6443
          protocol: tcp
        ingress:
          - subnet: 0.0.0.0/0
      # Allow NodePorts
      - name: nodeport-ingress
        portSelector:
          ports:
            - 30080
            - 30443
          protocol: tcp
        ingress:
          - subnet: 0.0.0.0/0
      # Allow CNI VXLAN traffic between nodes
      - name: cni-vxlan
        portSelector:
          ports:
            - 4789  # For Flannel VXLAN
          protocol: udp
        ingress:
          - subnet: 10.0.0.0/16